#!/usr/bin/env ruby

require 'turing_machine'

include TuringMachine

if ARGV[0].nil?
  exit(1)
else
  filename = ARGV[0]
end

if File.exist?(filename)
  raw_instructions = IO.read(filename)
else
  exit(2)
end

parser = InstructionsParser.new
instructions = parser.parse(raw_instructions)

initial_state = 'A'

instance = Instance.new(instructions, initial_state)

# This should be testable.
loop do
  puts instance.to_s
  break if instance.halted?
  instance.proceed
end
